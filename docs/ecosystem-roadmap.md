---
title: Windows 主控台和終端生態系統藍圖
description: 提供 Windows 主控台主機、主控台 API、主控台子系統和終端機產品之間互動和計畫的整體觀點。
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: 主控台, 終端機, 虛擬終端機, 主控台主機, 命令列, 子系統, 藍圖, 生態系統
ms.prod: console
ms.localizationpriority: high
ms.openlocfilehash: 3db266b761d4a8ee1fd8ec24d640bb277ab76edb
ms.sourcegitcommit: 281eb1469f77ae4fb4c67806898e14eac440522a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/14/2021
ms.locfileid: "100357898"
---
# <a name="windows-console-and-terminal-ecosystem-roadmap"></a><span data-ttu-id="a1563-104">Windows 主控台和終端生態系統藍圖</span><span class="sxs-lookup"><span data-stu-id="a1563-104">Windows Console and Terminal Ecosystem Roadmap</span></span>

<span data-ttu-id="a1563-105">本文件是 Windows 主控台和 Windows 終端機產品的整體藍圖。</span><span class="sxs-lookup"><span data-stu-id="a1563-105">This document is a high-level roadmap of the Windows Console and Windows Terminal products.</span></span> <span data-ttu-id="a1563-106">內容包括：</span><span class="sxs-lookup"><span data-stu-id="a1563-106">It covers:</span></span>


- <span data-ttu-id="a1563-107">Windows 主控台和 Windows 終端機如何適應 Windows 和其他作業系統上的命令列應用程式生態系統。</span><span class="sxs-lookup"><span data-stu-id="a1563-107">How Windows Console and Windows Terminal fit into the ecosystem of command-line applications across Windows and other operating systems.</span></span>

- <span data-ttu-id="a1563-108">產品、功能和策略的歷程記錄和未來藍圖，都是建置平台的一部分，也是專為此平台打造的。</span><span class="sxs-lookup"><span data-stu-id="a1563-108">A history and future roadmap of the products, features, and strategies that are part of building the platform, as well as building for this platform.</span></span>

<span data-ttu-id="a1563-109">Microsoft 目前的主控台/終端機時代重點是，在 Windows 平台上直接為開發人員帶來一流的終端機體驗，以及[淘汰](classic-vs-vt.md)傳統 Windows 主控台 API，並以利用 [pseudoconsole](pseudoconsoles.md)的[虛擬終端機序列](console-virtual-terminal-sequences.md)進行取代。</span><span class="sxs-lookup"><span data-stu-id="a1563-109">The focus of the current console/terminal era at Microsoft is to bring a first-class terminal experience directly to developers on the Windows platform and to [phase out](classic-vs-vt.md) classic Windows Console APIs, replacing them with [virtual terminal sequences](console-virtual-terminal-sequences.md) utilizing [pseudoconsole](pseudoconsoles.md).</span></span> <span data-ttu-id="a1563-110">**[Windows 終端機](/terminal/get-started)** 會展示轉換為一流體驗、從開發人員社群邀請 [開放原始碼共同作業](https://github.com/microsoft/terminal)、支援用戶端命令列和終端機主控應用程式的完整混合和比對，以及整合 Windows 生態系統與所有其他平台。</span><span class="sxs-lookup"><span data-stu-id="a1563-110">**[Windows Terminal](/terminal/get-started)** showcases this transition into a first-class experience, inviting [open source collaboration](https://github.com/microsoft/terminal) from the developer community, supporting a full spectrum of mixing and matching of client command-line and terminal hosting applications, and unifying the Windows ecosystem with all other platforms.</span></span>

## <a name="definitions"></a><span data-ttu-id="a1563-111">定義</span><span class="sxs-lookup"><span data-stu-id="a1563-111">Definitions</span></span>

<span data-ttu-id="a1563-112">在繼續之前，建議您先熟悉此空間中常用術語的[定義](definitions.md)。</span><span class="sxs-lookup"><span data-stu-id="a1563-112">It is recommended to familiarize yourself with the [definitions](definitions.md) of common terminology used in this space before proceeding.</span></span> <span data-ttu-id="a1563-113">常見術語包括：[命令列 (或主控台) 應用程式](definitions.md#command-line-applications)、[標準控點 (`STDIN`、`STDOUT`、`STDERR`)](definitions.md#standard-handles)、[TTY 和 PTY 裝置](definitions.md#ttypty)、[用戶端和伺服器](definitions.md#clients-and-servers)、[主控台子系統](definitions.md#console-subsystem)、[主控台主機](definitions.md#console-host)、[pseudoconsole](definitions.md#pseudoconsole) 和[終端機](definitions.md#terminal)。</span><span class="sxs-lookup"><span data-stu-id="a1563-113">Common terminology includes: [Command Line (or Console) applications](definitions.md#command-line-applications), [standard handles (`STDIN`, `STDOUT`, `STDERR`)](definitions.md#standard-handles), [TTY and PTY devices](definitions.md#ttypty), [clients and servers](definitions.md#clients-and-servers), [console subsystem](definitions.md#console-subsystem), [console host](definitions.md#console-host), [pseudoconsole](definitions.md#pseudoconsole), and [terminal](definitions.md#terminal).</span></span>

## <a name="architecture"></a><span data-ttu-id="a1563-114">架構</span><span class="sxs-lookup"><span data-stu-id="a1563-114">Architecture</span></span>

<span data-ttu-id="a1563-115">系統的一般架構分為四個部分：用戶端、裝置、伺服器和終端機。</span><span class="sxs-lookup"><span data-stu-id="a1563-115">The general architecture of the system is in four parts: client, device, server, and terminal.</span></span>

![命令列通訊流程圖：來源至目的地 (執行自用戶端到裝置到伺服器到終端機)](images/command-line-communication.png)

### <a name="client"></a><span data-ttu-id="a1563-117">用戶端</span><span class="sxs-lookup"><span data-stu-id="a1563-117">Client</span></span>

<span data-ttu-id="a1563-118">用戶端是一種使用文字型介面的命令列應用程式，可讓使用者輸入命令 (而不是滑鼠型使用者介面)，並傳回結果的文字呈現。</span><span class="sxs-lookup"><span data-stu-id="a1563-118">The client is a command-line application that uses a text-based interface to enable the user to enter commands (rather than a mouse-based user interface), returning a text representation of the result.</span></span> <span data-ttu-id="a1563-119">在 Windows 上，主控台 API 會在用戶端與裝置之間提供通訊層。</span><span class="sxs-lookup"><span data-stu-id="a1563-119">On Windows, the Console API provides a communications layer between the client and the device.</span></span> <span data-ttu-id="a1563-120">(這也可以是使用裝置控制 API 的標準主控台控點)。</span><span class="sxs-lookup"><span data-stu-id="a1563-120">(This can also be a standard console handle with device control APIs).</span></span>

### <a name="device"></a><span data-ttu-id="a1563-121">裝置</span><span class="sxs-lookup"><span data-stu-id="a1563-121">Device</span></span>

<span data-ttu-id="a1563-122">裝置是介於兩個程序 (用戶端與伺服器) 之間的中繼訊息處理通訊層。</span><span class="sxs-lookup"><span data-stu-id="a1563-122">The device is an intermediate message-handling communications layer between two processes, the client and the server.</span></span> <span data-ttu-id="a1563-123">在 Windows 上，這是主控台驅動程式。</span><span class="sxs-lookup"><span data-stu-id="a1563-123">On Windows, this is the console driver.</span></span> <span data-ttu-id="a1563-124">在其他平台上，則是 TTY 或 PTY 裝置。</span><span class="sxs-lookup"><span data-stu-id="a1563-124">On other platforms, it is the TTY or PTY device.</span></span> <span data-ttu-id="a1563-125">如果整個交易為純文字或包含[虛擬終端機序列](console-virtual-terminal-sequences.md)，而不是使用 [Windows 主控台 API](console-functions.md)，則檔案、管道和通訊端之類的其他裝置可作為此通訊通道。</span><span class="sxs-lookup"><span data-stu-id="a1563-125">Other devices like files, pipes, and sockets may be used as this communication channel if the entire transaction is in plain text or contains [virtual terminal sequences](console-virtual-terminal-sequences.md), but not with [Windows Console APIs](console-functions.md).</span></span>

### <a name="server"></a><span data-ttu-id="a1563-126">伺服器</span><span class="sxs-lookup"><span data-stu-id="a1563-126">Server</span></span>

<span data-ttu-id="a1563-127">伺服器會從用戶端解讀要求的 API 呼叫或訊息。</span><span class="sxs-lookup"><span data-stu-id="a1563-127">The server interprets the requested API calls or messages from the client.</span></span> <span data-ttu-id="a1563-128">在傳統作業模式的 Windows 上，伺服器也會建立使用者介面，以將輸出呈現至螢幕。</span><span class="sxs-lookup"><span data-stu-id="a1563-128">On Windows in the classic operating mode, the server also creates a user interface to present the output to the screen.</span></span> <span data-ttu-id="a1563-129">伺服器會另外收集輸入，以透過驅動程式 (例如在相同模組中搭售的終端機) 將回應訊息傳回給用戶端。</span><span class="sxs-lookup"><span data-stu-id="a1563-129">The server additionally collects input to send back in response messages to the client, via the driver, like a terminal bundled in the same module.</span></span> <span data-ttu-id="a1563-130">使用 [pseudoconsole](pseudoconsoles.md) 模式，其只是用來向連結的終端機呈現[虛擬終端機序列](console-virtual-terminal-sequences.md)中此資訊的翻譯工具。</span><span class="sxs-lookup"><span data-stu-id="a1563-130">Using [pseudoconsole](pseudoconsoles.md) mode, it instead is only a translator to present this information in [virtual terminal sequences](console-virtual-terminal-sequences.md) to an attached terminal.</span></span>

### <a name="terminal"></a><span data-ttu-id="a1563-131">終端</span><span class="sxs-lookup"><span data-stu-id="a1563-131">Terminal</span></span>

<span data-ttu-id="a1563-132">終端機是為使用者提供圖形化顯示和互動服務的最後一層。</span><span class="sxs-lookup"><span data-stu-id="a1563-132">The terminal is the final layer providing graphical display and interactivity services to the user.</span></span> <span data-ttu-id="a1563-133">其負責擷取輸入並將其編碼為[虛擬終端機序列](console-virtual-terminal-sequences.md)，這最終會到達用戶端的 `STDIN`。</span><span class="sxs-lookup"><span data-stu-id="a1563-133">It is responsible for capturing input and encoding it as [virtual terminal sequences](console-virtual-terminal-sequences.md), which eventually reach the client's `STDIN`.</span></span> <span data-ttu-id="a1563-134">此外，也會接收和解碼其從用戶端的 `STDOUT` 接收回來的虛擬終端機序列，以在螢幕上呈現。</span><span class="sxs-lookup"><span data-stu-id="a1563-134">It will also receive and decode the *virtual terminal sequences* that it receives back from the client's `STDOUT` for presentation on the screen.</span></span>

#### <a name="further-connections"></a><span data-ttu-id="a1563-135">進一步連線</span><span class="sxs-lookup"><span data-stu-id="a1563-135">Further connections</span></span>

<span data-ttu-id="a1563-136">追加功能：將扮演多個角色的應用程式鏈結到其中一個端點，即可執行進一步連線。</span><span class="sxs-lookup"><span data-stu-id="a1563-136">As an addendum, further connections can be performed by chaining applications that serve multiple roles into one of the endpoints.</span></span> <span data-ttu-id="a1563-137">例如，SSH 工作階段有兩個角色：這是在某個裝置上執行之命令列應用程式的 **終端機**，但是會將所有收到的資訊轉送給另一個裝置上的 **用戶端** 角色。</span><span class="sxs-lookup"><span data-stu-id="a1563-137">For instance, an SSH session has two roles: it is a **terminal** for the command-line application running on one device, but it forwards all received information on to a **client** role on another device.</span></span> <span data-ttu-id="a1563-138">此鏈結可以會在不同裝置和內容之間無限期地發生，以提供廣泛的案例彈性。</span><span class="sxs-lookup"><span data-stu-id="a1563-138">This chaining can occur indefinitely across devices and contexts offering broad scenario flexibility.</span></span>

<span data-ttu-id="a1563-139">在非 Windows 平台上，**伺服器** 和 **終端機** 角色都是單一單位，因為 API 集與 [虛擬終端機序列](console-virtual-terminal-sequences.md)之間不需要轉譯相容性層。</span><span class="sxs-lookup"><span data-stu-id="a1563-139">On non-Windows platforms, the **server** and **terminal** roles are a single unit because there is no need for a translation compatibility layer between an API set and [virtual terminal sequences](console-virtual-terminal-sequences.md).</span></span>

## <a name="microsoft-products"></a><span data-ttu-id="a1563-140">Microsoft 產品</span><span class="sxs-lookup"><span data-stu-id="a1563-140">Microsoft products</span></span>

<span data-ttu-id="a1563-141">您現在可以在 GitHub 上的開放原始碼存放庫 ([microsoft/terminal](https://github.com/microsoft/terminal)) 中找到所有 Microsoft Windows 命令列產品。</span><span class="sxs-lookup"><span data-stu-id="a1563-141">All of the Microsoft Windows command-line products are now available on GitHub in an open source repository, [microsoft/terminal](https://github.com/microsoft/terminal).</span></span>

### <a name="windows-console-host"></a><span data-ttu-id="a1563-142">Windows 主控台主機</span><span class="sxs-lookup"><span data-stu-id="a1563-142">Windows Console Host</span></span>

<span data-ttu-id="a1563-143">這是命令列應用程式的傳統 Windows 使用者介面。</span><span class="sxs-lookup"><span data-stu-id="a1563-143">This is the traditional Windows user-interface for command-line applications.</span></span> <span data-ttu-id="a1563-144">可處理從任何已連結命令列應用程式呼叫的所有主控台 API 服務。</span><span class="sxs-lookup"><span data-stu-id="a1563-144">It handles all console API servicing called from any attached command-line application.</span></span> <span data-ttu-id="a1563-145">Windows 主控台也會代表所有應用程式來處理圖形化使用者介面 (GUI) 呈現。</span><span class="sxs-lookup"><span data-stu-id="a1563-145">Windows Console also handles the graphical user interface (GUI) representation on behalf of all of those applications.</span></span> <span data-ttu-id="a1563-146">在系統目錄中可找到 `conhost.exe`，或在其開放原始碼表單中找到的 `openconsole.exe`。</span><span class="sxs-lookup"><span data-stu-id="a1563-146">It is found in the system directory as `conhost.exe`, or `openconsole.exe` in its open source form.</span></span> <span data-ttu-id="a1563-147">其隨附於 Windows 作業系統。</span><span class="sxs-lookup"><span data-stu-id="a1563-147">It comes with the Windows operating system.</span></span> <span data-ttu-id="a1563-148">在從開放原始碼存放庫建置的其他 Microsoft 產品中也可以找到，以供取得 [pseudoconsole](pseudoconsoles.md) 基礎結構的最新實作。</span><span class="sxs-lookup"><span data-stu-id="a1563-148">It can also be found in other Microsoft products built from the open source repository for a more up-to-date implementation of the [pseudoconsole](pseudoconsoles.md) infrastructure.</span></span> <span data-ttu-id="a1563-149">根據上述定義，其會透過慣用的 pseudoconsole 基礎結構，以傳統上兼具伺服器和終端機的角色或僅限伺服器的角色運作。</span><span class="sxs-lookup"><span data-stu-id="a1563-149">Per the definitions above, it operates in either a combined server-and-terminal role traditionally or a server-only role through the preferred _pseudoconsole_ infrastructure.</span></span>

### <a name="windows-terminal"></a><span data-ttu-id="a1563-150">Windows 終端機</span><span class="sxs-lookup"><span data-stu-id="a1563-150">Windows Terminal</span></span>

<span data-ttu-id="a1563-151">這是命令列應用程式的新 Windows 介面。</span><span class="sxs-lookup"><span data-stu-id="a1563-151">This is the new Windows interface for command-line applications.</span></span> <span data-ttu-id="a1563-152">Windows 終端機可作為以下情況的第一方範例：使用 [pseudoconsole](pseudoconsoles.md) 來區分 API 服務與文字型應用程式介面之間的顧慮，非常類似所有非 Windows 平台。</span><span class="sxs-lookup"><span data-stu-id="a1563-152">Windows Terminal serves as a first-party example of using the [pseudoconsole](pseudoconsoles.md) to separate the concerns between API servicing and text-based application interfacing, much like all non-Windows platforms.</span></span>


<span data-ttu-id="a1563-153">Windows 終端機是適用於 Windows 的旗艦型文字模式使用者介面。</span><span class="sxs-lookup"><span data-stu-id="a1563-153">Windows Terminal is the flagship text-mode user interface for Windows.</span></span> <span data-ttu-id="a1563-154">其會示範生態系統的功能，並將 Windows 開發推向與其他平台整合。</span><span class="sxs-lookup"><span data-stu-id="a1563-154">It demonstrates the capabilities of the ecosystem and is driving Windows development toward unifying with other platforms.</span></span> <span data-ttu-id="a1563-155">Windows 終端機也是如何建置功能強大且複雜新式應用程式的範例，此種應用程式橫越 Windows API 和架構的歷史和全程。</span><span class="sxs-lookup"><span data-stu-id="a1563-155">Windows Terminal is also an example of how to build a robust and complex modern application that spans the history and gamut of Windows APIs and frameworks.</span></span> <span data-ttu-id="a1563-156">根據上述定義，此產品會以終端機角色運作。</span><span class="sxs-lookup"><span data-stu-id="a1563-156">Per the definitions above, this product operates in a terminal role.</span></span>

## <a name="major-historical-milestones"></a><span data-ttu-id="a1563-157">過去主要的里程碑</span><span class="sxs-lookup"><span data-stu-id="a1563-157">Major historical milestones</span></span>

<span data-ttu-id="a1563-158">主控台子系統過去主要的里程碑細分為 2014 年前實作，然後移到自 2014 年起的工作概觀，而當時命令列上更新的焦點是在 Windows 10 年代中形成。</span><span class="sxs-lookup"><span data-stu-id="a1563-158">The major historical milestones for the console subsystem are broken into implementation prior to 2014 and then moves into an overview of work performed since 2014, when the renewed focus on the command-line was formed in the Windows 10 era.</span></span>

### <a name="initial-implementation"></a><span data-ttu-id="a1563-159">初始實作</span><span class="sxs-lookup"><span data-stu-id="a1563-159">Initial Implementation</span></span>

<span data-ttu-id="a1563-160">**\[1989-1990 年代]** 初始主控台主機系統已實作為 Windows 作業系統中 DOS 環境的模擬。</span><span class="sxs-lookup"><span data-stu-id="a1563-160">**\[1989-1990s]** The initial console host system was implemented as an emulation of the DOS environment within the Windows operating system.</span></span> <span data-ttu-id="a1563-161">其程式碼會與[命令提示字元](/windows-server/administration/windows-commands/cmd)(`cmd.exe`) 糾結在一起並協同合作，這是該 DOS 環境的表示法。</span><span class="sxs-lookup"><span data-stu-id="a1563-161">Its code is entangled and cooperative with the [Command Prompt](/windows-server/administration/windows-commands/cmd), `cmd.exe`, that is a representation of that DOS environment.</span></span> <span data-ttu-id="a1563-162">主控台主機系統程式碼會與命令提示字元解譯器/shell 一起分擔責任和權限。</span><span class="sxs-lookup"><span data-stu-id="a1563-162">The console host system code shares responsibilities and privileges with the Command Prompt interpreter/shell.</span></span> <span data-ttu-id="a1563-163">其也會提供服務的基底層級，讓其他命令列公用程式以類似 CMD 的方式執行服務。</span><span class="sxs-lookup"><span data-stu-id="a1563-163">It also provides a base level of services for other command-line utilities to perform services in a CMD-like manner.</span></span>

### <a name="dbcs-for-cjk"></a><span data-ttu-id="a1563-164">適用於 CJK 的 DBCS</span><span class="sxs-lookup"><span data-stu-id="a1563-164">DBCS for CJK</span></span>

<span data-ttu-id="a1563-165">**\[1997-1999\]** 這段時間，引進了 [DBCS](/windows/win32/intl/double-byte-character-sets) 支援 (「雙位元組字元集」) 來支援 CJK (中文、日文和韓文) 市場。</span><span class="sxs-lookup"><span data-stu-id="a1563-165">**\[1997-1999\]** Around this time, [DBCS](/windows/win32/intl/double-byte-character-sets) support ("Double-byte character set") is introduced to support CJK (Chinese, Japanese, and Korean) markets.</span></span> <span data-ttu-id="a1563-166">此種努力導致在主控台內許多寫入和讀取方法的分歧，以提供「西方」版本來處理單一位元組字元，以及「東方」版本的替代表示法，其中需要兩個位元組來代表龐大的字元陣列。</span><span class="sxs-lookup"><span data-stu-id="a1563-166">This effort results in a bifurcation of many of the writing and reading methods inside the console to provide both "western" versions to deal with single-byte characters as well as an alternative representation for "eastern" versions where two bytes are required to represent the vast array of characters.</span></span> <span data-ttu-id="a1563-167">此分歧包括將主控台環境中儲存格的呈現展開為 1 或 2 個儲存格，其中 1 個儲存格是窄的 (高度大於寬度)，2 個儲存格則是寬的、全形，或者是可在其銘寫典型中文、日文和韓文表意文字的方形。</span><span class="sxs-lookup"><span data-stu-id="a1563-167">This bifurcation included the expanding representation of a cell in the console environment to be either 1 or 2 cells wide, where 1 cell is narrow (taller than it is wide) and 2 cells is wide, full-width, or otherwise a square in which typical Chinese, Japanese, and Korean ideographs can be inscribed.</span></span>

### <a name="securityisolation"></a><span data-ttu-id="a1563-168">安全性/隔離</span><span class="sxs-lookup"><span data-stu-id="a1563-168">Security/Isolation</span></span>

<span data-ttu-id="a1563-169">**\[2005-2009\]** 透過在關鍵系統程序 (`csrss.exe`) 內執行的主控台子系統體驗，將各種不同存取層級的各式用戶端應用程式連線到單一超級關鍵和具特殊權限的程序，特別危險。</span><span class="sxs-lookup"><span data-stu-id="a1563-169">**\[2005-2009\]** With the console subsystem experience running inside the critical system process, `csrss.exe`, connecting assorted client applications, at varying access levels, to a single super-critical and privileged process was noticed as particularly dangerous.</span></span> <span data-ttu-id="a1563-170">在此年代中，主控台子系統已分割成用戶端、驅動程式和伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="a1563-170">In this era, the console subsystem was split into client, driver, and server applications.</span></span> <span data-ttu-id="a1563-171">每個應用程式都可以在自己的內容中執行，進而降低各自的責任和權限。</span><span class="sxs-lookup"><span data-stu-id="a1563-171">Each application could run in their own context, reducing the responsibilities and privilege in each.</span></span> <span data-ttu-id="a1563-172">此種隔離提升了系統的一般穩固性，因為主控台子系統中的任何失敗不會再影響其他關鍵程序功能。</span><span class="sxs-lookup"><span data-stu-id="a1563-172">This isolation increased the general robustness of the system, as any failure in the console subsystem no longer affected other critical process functionality.</span></span>

### <a name="user-experience-improvements"></a><span data-ttu-id="a1563-173">使用者經驗改進</span><span class="sxs-lookup"><span data-stu-id="a1563-173">User Experience Improvements</span></span>

<span data-ttu-id="a1563-174">**\[2014-2016\]** 經過一段很長的時間，由組織內各種小組分散維護主控台子系統之後，以開發人員為主的新小組形成了，負責推動主控台的改進。</span><span class="sxs-lookup"><span data-stu-id="a1563-174">**\[2014-2016\]** After a long time of generally scattered maintenance of the console subsystem by assorted teams across the organization, a new developer-focused team was formed to own and drive improvements in the console.</span></span> <span data-ttu-id="a1563-175">這段期間的改進包括：行選取、平滑視窗大小調整、自動重排文字、複製和貼上、高 DPI 支援，以及著重於 Unicode，包括「西方」與「東方」儲存體和資料流操作演算法分裂的匯聚。</span><span class="sxs-lookup"><span data-stu-id="a1563-175">Improvements during this time included: line selection, smooth window resizing, reflowing text, copy and paste, high DPI support, and a focus on Unicode, including the convergence of the split between "western" and "eastern" storage and stream manipulation algorithms.</span></span>

### <a name="virtual-terminal-client"></a><span data-ttu-id="a1563-176">虛擬終端機用戶端</span><span class="sxs-lookup"><span data-stu-id="a1563-176">Virtual Terminal client</span></span>

<span data-ttu-id="a1563-177">**\[2015-2017\]** 隨著 [Windows 子系統 Linux 版](/windows/wsl/)的到來，Microsoft 致力於改善 [Windows 上的 Docker](/dotnet/architecture/microservices/container-docker-introduction/docker-defined) 體驗，並採用 [OpenSSH](/windows-server/administration/openssh/openssh_overview) 作為首要命令列遠端執行技術，而主控台主機引進了 [虛擬終端機序列](console-virtual-terminal-sequences.md)的初始實作。</span><span class="sxs-lookup"><span data-stu-id="a1563-177">**\[2015-2017\]** With the arrival of the [Windows Subsystem for Linux](/windows/wsl/), Microsoft efforts to improve the experience of [Docker on Windows](/dotnet/architecture/microservices/container-docker-introduction/docker-defined), and the adoption of [OpenSSH](/windows-server/administration/openssh/openssh_overview) as the premier command-line remote execution technology, the initial implementations of [virtual terminal sequences](console-virtual-terminal-sequences.md) were introduced into the console host.</span></span> <span data-ttu-id="a1563-178">這可讓現有主控台充當終端機，直接連結到其各自環境中的 Linux 原生應用程式，將圖形化和文字屬性轉譯至顯示器，並以適當的方言傳回使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="a1563-178">This allowed the existing console to act as the terminal, attached directly to those Linux-native applications in their respective environments, rendering graphical and text attributes to the display and returning user input in the appropriate dialect.</span></span>

### <a name="virtual-terminal-server"></a><span data-ttu-id="a1563-179">虛擬終端機伺服器</span><span class="sxs-lookup"><span data-stu-id="a1563-179">Virtual Terminal server</span></span>

<span data-ttu-id="a1563-180">**\[2018\]** 過去二十年來，建立了收件匣主控台主機的第三方替代方案，以提供額外的開發人員生產力，其醒目地置於豐富的自訂項目和索引標籤式介面的中間。</span><span class="sxs-lookup"><span data-stu-id="a1563-180">**\[2018\]** Over the past twenty years, third-party alternatives for the inbox console host were created to offer additional developer productivity, prominently centered in rich customizations and tabbed interfaces.</span></span> <span data-ttu-id="a1563-181">這些應用程式仍然需要執行和隱藏主控台主機視窗。</span><span class="sxs-lookup"><span data-stu-id="a1563-181">These applications still needed to run and hide the console host window.</span></span> <span data-ttu-id="a1563-182">其會連結為次要的「用戶端」應用程式，以在主要命令列用戶端應用程式運作時，消除輪詢迴圈中的緩衝區資訊。</span><span class="sxs-lookup"><span data-stu-id="a1563-182">They attach as a secondary "client" application to scrape out buffer information in polling loops as the primary command-line client application operated.</span></span> <span data-ttu-id="a1563-183">其目標是要成為終端機，如同在其他平台上，但是在 Windows 世界中，終端機不是可更換的。</span><span class="sxs-lookup"><span data-stu-id="a1563-183">Their goal was to be a terminal, like on other platforms, but in the Windows world where terminals were not replaceable.</span></span>

<span data-ttu-id="a1563-184">在這段時間內，引進了 [pseudoconsole](pseudoconsoles.md) 基礎結構。</span><span class="sxs-lookup"><span data-stu-id="a1563-184">In this time period, the [pseudoconsole](pseudoconsoles.md) infrastructure was introduced.</span></span> <span data-ttu-id="a1563-185">Pseudoconsole 允許任何應用程式以非互動式模式啟動主控台主機，並成為使用者的最終終端機介面。</span><span class="sxs-lookup"><span data-stu-id="a1563-185">Pseudoconsole permits any application to launch the console host in a non-interactive mode and become the final terminal interface for the user.</span></span> <span data-ttu-id="a1563-186">此種作法的主要限制是 Windows 未來為所有已發佈的 [Windows 主控台 API](console-functions.md) 提供無限期服務的持續相容性承諾，同時提供符合所有其他平台上期望的替代伺服器主控介面：[虛擬終端機序列](console-virtual-terminal-sequences.md)。</span><span class="sxs-lookup"><span data-stu-id="a1563-186">The main limitation in this effort was the continued compatibility promise of Windows in servicing all published [Windows Console APIs](console-functions.md) for the indefinite future, while providing a replacement server-hosting interface that matched what is expected on all other platforms: [virtual terminal sequences](console-virtual-terminal-sequences.md).</span></span> <span data-ttu-id="a1563-187">因此，此種作法執行了用戶端階段的鏡映影像：pseudoconsole 會將畫面上會顯示的內容投射為委派主機的「虛擬終端機序列」，並將回覆轉譯為用戶端應用程式使用量的 Windows 格式輸入序列。</span><span class="sxs-lookup"><span data-stu-id="a1563-187">As such, this effort performed the mirror image of the client phase: the _pseudoconsole_ projects what would be displayed onto the screen as _virtual terminal sequences_ for a delegated host and interprets replies into Windows-format input sequences for client application consumption.</span></span>

## <a name="roadmap-for-the-future"></a><span data-ttu-id="a1563-188">未來的藍圖</span><span class="sxs-lookup"><span data-stu-id="a1563-188">Roadmap for the future</span></span>

### <a name="terminal-applications"></a><span data-ttu-id="a1563-189">終端機應用程式</span><span class="sxs-lookup"><span data-stu-id="a1563-189">Terminal applications</span></span>

<span data-ttu-id="a1563-190">**\[2019-現在\]** 這是主控台子系統的開放原始碼時代，著重於新的 Windows 終端機。</span><span class="sxs-lookup"><span data-stu-id="a1563-190">**\[2019-Now\]** This is the open source era for the console subsystem, focusing on the new Windows Terminal.</span></span> <span data-ttu-id="a1563-191">2019 年 5 月的 Microsoft Build 會議期間宣佈，Windows 終端機完全放在 GitHub 的 [Microsoft/Terminal](https://github.com/microsoft/terminal) 上。</span><span class="sxs-lookup"><span data-stu-id="a1563-191">Announced during the Microsoft Build conference in May 2019, Windows Terminal is entirely on GitHub at [microsoft/terminal](https://github.com/microsoft/terminal).</span></span> <span data-ttu-id="a1563-192">在 [pseudoconsole](pseudoconsoles.md) 的精簡平台上建置 Windows 終端機應用程式，將成為這個時代的焦點，並在 Windows 平台上直接為開發人員帶來一流的終端機體驗。</span><span class="sxs-lookup"><span data-stu-id="a1563-192">Building the Windows Terminal application on top of the refined platform for [pseudoconsole](pseudoconsoles.md) will be the focus of this era, bringing a first-class terminal experience directly to developers on the Windows platform.</span></span>

<span data-ttu-id="a1563-193">**[Windows 終端機](/terminal/get-started)** 不僅要展示平台 (包括 [WinUI](/apps/winui/) 介面技術、[MSIX](/msix/) 封裝模型，以及 [C++/WinRT](/uwp/cpp-and-winrt-apis/) 元件架構)，還要成為平台本身的驗證。</span><span class="sxs-lookup"><span data-stu-id="a1563-193">**[Windows Terminal](/terminal/get-started)** intends not only to showcase the platform — including the [WinUI](/apps/winui/) interface technology, the [MSIX](/msix/) packaging model, and the [C++/WinRT](/uwp/cpp-and-winrt-apis/) component architecture — but also as a validation of the platform itself.</span></span> <span data-ttu-id="a1563-194">Windows 終端機會促使 Windows 組織開啟應用程式平台並視需要改進，以繼續提升開發人員的生產力。</span><span class="sxs-lookup"><span data-stu-id="a1563-194">Windows Terminal is driving the Windows organization to open and evolve the app platform as necessary to continue to lift the productivity of developers.</span></span> <span data-ttu-id="a1563-195">Windows 終端機獨特的進階使用者和開發人員需求推動了現代化 Windows 平台需求，以滿足這些市場對於 Windows 的真正需求。</span><span class="sxs-lookup"><span data-stu-id="a1563-195">The Windows Terminal unique set of power user and developer requirements drive the modern Windows platform requirements for what those markets truly need from Windows.</span></span>

<span data-ttu-id="a1563-196">在 Windows 作業系統中，這包括從預設位置中[淘汰傳統主控台主機使用者介面](./classic-vs-vt.md)，改為支持 [Windows 終端機](/terminal/get-started)、[ConPTY](https://devblogs.microsoft.com/commandline/windows-command-line-introducing-the-windows-pseudo-console-conpty/)和[虛擬終端機序列](console-virtual-terminal-sequences.md)。</span><span class="sxs-lookup"><span data-stu-id="a1563-196">Inside the Windows operating system, this includes [retiring the classic console host user interface](./classic-vs-vt.md) from its default position in favor of [Windows Terminal](/terminal/get-started), [ConPTY](https://devblogs.microsoft.com/commandline/windows-command-line-introducing-the-windows-pseudo-console-conpty/), and [virtual terminal sequences](console-virtual-terminal-sequences.md).</span></span>

<span data-ttu-id="a1563-197">最後，不管是 Windows 終端機產品還是任何替代終端機，這個時代都想要提供完全自選的預設體驗。</span><span class="sxs-lookup"><span data-stu-id="a1563-197">Lastly, this era intends to offer full choice over the default experience, whether it is the Windows Terminal product or any alternative terminals.</span></span>

### <a name="client-support-library"></a><span data-ttu-id="a1563-198">用戶端支援程式庫</span><span class="sxs-lookup"><span data-stu-id="a1563-198">Client support library</span></span>

<span data-ttu-id="a1563-199">**\[未來\]** 有了用戶端的 [虛擬終端機序列](console-virtual-terminal-sequences.md)支援和文件，強烈鼓勵 Windows 命令列公用程式開發人員先透過傳統 Windows API 使用虛擬終端機序列，以獲得整合生態系統與所有平台的優點。</span><span class="sxs-lookup"><span data-stu-id="a1563-199">**\[Future\]** With the support and documentation of [virtual terminal sequences](console-virtual-terminal-sequences.md) on the client side, we strongly encourage Windows command-line utility developers to use virtual terminal sequences first over the classic Windows APIs to gain the benefit of a unified ecosystem with all platforms.</span></span> <span data-ttu-id="a1563-200">不過，遺漏了一個重要的部分，那就是其他平台都有一系列廣泛的用戶端協助程式程式庫，可供處理 [readline](https://tiswww.case.edu/php/chet/readline/rltop.html) 之類的輸入和 [ncurses](https://invisible-island.net/ncurses/ncurses.html) 之類的圖形化顯示。</span><span class="sxs-lookup"><span data-stu-id="a1563-200">However, one significant missing piece is that other platforms have a wide array of client-side helper libraries for handling input like [readline](https://tiswww.case.edu/php/chet/readline/rltop.html) and graphical display like [ncurses](https://invisible-island.net/ncurses/ncurses.html).</span></span> <span data-ttu-id="a1563-201">這個特定的未來藍圖元素代表探索生態系統所提供的內容，以及如何透過傳統主控台 API，加速在 Windows 命令列應用程式中採用虛擬終端機序列。</span><span class="sxs-lookup"><span data-stu-id="a1563-201">This particular future road map element represents the exploration of what the ecosystem offers and how we can accelerate the adoption of virtual terminal sequences in Windows command-line applications over the classic Console API.</span></span>

### <a name="sequence-passthrough"></a><span data-ttu-id="a1563-202">序列傳遞</span><span class="sxs-lookup"><span data-stu-id="a1563-202">Sequence Passthrough</span></span>

<span data-ttu-id="a1563-203">**\[未來\]** 虛擬終端機用戶端與伺服器實作的組合，可讓用戶端命令列和終端機主控應用程式完全混搭。</span><span class="sxs-lookup"><span data-stu-id="a1563-203">**\[Future\]** The combination of virtual terminal client and server implementations allows the full mixing and matching of client command-line and terminal hosting applications.</span></span> <span data-ttu-id="a1563-204">此種組合對傳統 [Windows 主控台 API](console-functions.md) 或[虛擬終端機序列](console-virtual-terminal-sequences.md)都有吸引力，不過，將此轉譯成傳統相容的 Windows 方法，然後再回到更通用的虛擬終端機方法，會產生額外負荷成本。</span><span class="sxs-lookup"><span data-stu-id="a1563-204">This combination can speak to either the classic [Windows Console APIs](console-functions.md) or [virtual terminal sequences](console-virtual-terminal-sequences.md), however, there is an overhead cost to translating this into the classic compatible Windows method and then back into the more universal virtual terminal method.</span></span>

<span data-ttu-id="a1563-205">一旦市場充分採用 Windows 上的虛擬終端機序列和 UTF-8，就可以選擇性地停用主控台主機的轉換/轉譯作業。</span><span class="sxs-lookup"><span data-stu-id="a1563-205">Once the market sufficiently adopts _virtual terminal sequences_ and UTF-8 on Windows, the conversion/interpretation job of the console host can be optionally disabled.</span></span> <span data-ttu-id="a1563-206">主控台主機接著會變成簡單的 API 呼叫服務工具，並透過 [pseudoconsole](pseudoconsoles.md) 從裝置呼叫轉送至主控應用程式。</span><span class="sxs-lookup"><span data-stu-id="a1563-206">The console host would then become a simple API call servicer and relay from device calls to the hosting application via the [pseudoconsole](pseudoconsoles.md).</span></span> <span data-ttu-id="a1563-207">這項變更將會提升效能，並充分發揮可在用戶端應用程式與終端機之間傳達的序列方言。</span><span class="sxs-lookup"><span data-stu-id="a1563-207">This change will increase performance and maximize the dialect of sequences that can be spoken between the client application and the terminal.</span></span> <span data-ttu-id="a1563-208">透過這項變更會達成其他互動性案例，而 (最終) 讓 Windows 世界與命令列應用程式空間中的所有其他平台系列保持一致。</span><span class="sxs-lookup"><span data-stu-id="a1563-208">Through this change additional interactivity scenarios would be enabled and *(finally)* bring the Windows world into alignment with the family of all other platforms in the command-line application space.</span></span>