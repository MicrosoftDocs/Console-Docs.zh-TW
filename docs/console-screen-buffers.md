---
title: 主控台畫面緩衝區
description: 「畫面緩衝區」是主控台視窗輸出中字元和色彩資料的二維陣列。
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: 主控台, 字元模式應用程式, 命令列應用程式, 終端機應用程式, 主控台 api
MS-HAID:
- '\_win32\_console\_screen\_buffers'
- base.console\_screen\_buffers
- consoles.console\_screen\_buffers
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: f94995fc-5f5f-4fcd-969d-7e10020634c2
ms.localizationpriority: high
ms.openlocfilehash: 7d617b48676c0e4272d11dea3c1bd990f4334d11
ms.sourcegitcommit: 281eb1469f77ae4fb4c67806898e14eac440522a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/14/2021
ms.locfileid: "100358087"
---
# <a name="console-screen-buffers"></a><span data-ttu-id="a9164-104">主控台畫面緩衝區</span><span class="sxs-lookup"><span data-stu-id="a9164-104">Console Screen Buffers</span></span>

<span data-ttu-id="a9164-105">「畫面緩衝區」是在主控台視窗輸出中字元和色彩資料的二維陣列。</span><span class="sxs-lookup"><span data-stu-id="a9164-105">A *screen buffer* is a two-dimensional array of character and color data for output in a console window.</span></span> <span data-ttu-id="a9164-106">主控台可以有多個畫面緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a9164-106">A console can have multiple screen buffers.</span></span> <span data-ttu-id="a9164-107">「作用中的畫面緩衝區」是顯示在畫面上的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a9164-107">The *active screen buffer* is the one that is displayed on the screen.</span></span>

<span data-ttu-id="a9164-108">系統會在每次建立新的主控台時建立畫面緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a9164-108">The system creates a screen buffer whenever it creates a new console.</span></span> <span data-ttu-id="a9164-109">若要對主控台的作用中畫面緩衝區開啟控制代碼，請在對 [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) 函式的呼叫中，指定 **CONOUT$** 值。</span><span class="sxs-lookup"><span data-stu-id="a9164-109">To open a handle to a console's active screen buffer, specify the **CONOUT$** value in a call to the [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="a9164-110">程序可以使用 [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) 函式，為其主控台建立額外的畫面緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a9164-110">A process can use the [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function to create additional screen buffers for its console.</span></span> <span data-ttu-id="a9164-111">若要讓新的畫面緩衝區開始作用，則必須在呼叫 [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) 函式時指定其控制代碼。</span><span class="sxs-lookup"><span data-stu-id="a9164-111">A new screen buffer is not active until its handle is specified in a call to the [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) function.</span></span> <span data-ttu-id="a9164-112">不過，無論畫面緩衝區是否在作用中，您都可以加以存取以進行讀取和寫入。</span><span class="sxs-lookup"><span data-stu-id="a9164-112">However, screen buffers can be accessed for reading and writing whether they are active or inactive.</span></span>

<span data-ttu-id="a9164-113">每個畫面緩衝區本身都有字元資訊記錄的二維陣列。</span><span class="sxs-lookup"><span data-stu-id="a9164-113">Each screen buffer has its own two-dimensional array of character information records.</span></span> <span data-ttu-id="a9164-114">每個字元的資料會以 [**CHAR\_INFO**](char-info-str.md) 結構儲存，該結構可指定 Unicode 或 ANSI 字元，以及該字元顯示的前景和背景色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-114">The data for each character is stored in a [**CHAR\_INFO**](char-info-str.md) structure that specifies the Unicode or ANSI character and the foreground and background colors in which that character is displayed.</span></span>

<span data-ttu-id="a9164-115">您可以針對每個畫面緩衝區，個別設定與畫面緩衝區相關聯的一些屬性。</span><span class="sxs-lookup"><span data-stu-id="a9164-115">A number of properties associated with a screen buffer can be set independently for each screen buffer.</span></span> <span data-ttu-id="a9164-116">這表示變更作用中的畫面緩衝區對主控台視窗外觀可能會有很大的影響。</span><span class="sxs-lookup"><span data-stu-id="a9164-116">This means that changing the active screen buffer can have a dramatic effect on the appearance of the console window.</span></span> <span data-ttu-id="a9164-117">與畫面緩衝區相關聯的屬性包括：</span><span class="sxs-lookup"><span data-stu-id="a9164-117">The properties associated with a screen buffer include:</span></span>

- <span data-ttu-id="a9164-118">畫面緩衝區大小 (字元資料列和資料行數目)。</span><span class="sxs-lookup"><span data-stu-id="a9164-118">Screen buffer size, in character rows and columns.</span></span>
- <span data-ttu-id="a9164-119">文字屬性 (顯示 [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile) 或 [**WriteConsole**](writeconsole.md) 函式所寫入文字的前景和背景色彩)。</span><span class="sxs-lookup"><span data-stu-id="a9164-119">Text attributes (foreground and background colors for displaying text to be written by the [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile) or [**WriteConsole**](writeconsole.md) function).</span></span>
- <span data-ttu-id="a9164-120">視窗大小和位置 (在主控台視窗中顯示主控台畫面緩衝區的矩形區域)。</span><span class="sxs-lookup"><span data-stu-id="a9164-120">Window size and location (the rectangular region of the console screen buffer that is displayed in the console window).</span></span>
- <span data-ttu-id="a9164-121">游標位置、外觀和可見度。</span><span class="sxs-lookup"><span data-stu-id="a9164-121">Cursor position, appearance, and visibility.</span></span>
- <span data-ttu-id="a9164-122">輸出模式 (**ENABLE\_PROCESSED\_OUTPUT** 和 **ENABLE\_WRAP\_AT\_EOL\_OUTPUT**)。</span><span class="sxs-lookup"><span data-stu-id="a9164-122">Output modes (**ENABLE\_PROCESSED\_OUTPUT** and **ENABLE\_WRAP\_AT\_EOL\_OUTPUT**).</span></span> <span data-ttu-id="a9164-123">如需有關主控台輸出模式的詳細資訊，請參閱[高階主控台模式](high-level-console-modes.md)。</span><span class="sxs-lookup"><span data-stu-id="a9164-123">For more information about console output modes, see [High-Level Console Modes](high-level-console-modes.md).</span></span>

<span data-ttu-id="a9164-124">畫面緩衝區建立時，即會在每個位置包含空白字元。</span><span class="sxs-lookup"><span data-stu-id="a9164-124">When a screen buffer is created, it contains space characters in every position.</span></span> <span data-ttu-id="a9164-125">其游標會顯示並放置在緩衝區的原點 (0,0)，而視窗左上角的位置會放在緩衝區的原點上。</span><span class="sxs-lookup"><span data-stu-id="a9164-125">Its cursor is visible and positioned at the buffer's origin (0,0), and the window is positioned with its upper left corner at the buffer's origin.</span></span> <span data-ttu-id="a9164-126">主控台畫面緩衝區的大小、視窗大小、文字屬性以及游標的外觀，都是由使用者或系統預設值所決定。</span><span class="sxs-lookup"><span data-stu-id="a9164-126">The size of the console screen buffer, the window size, the text attributes, and the appearance of the cursor are determined by the user or by the system defaults.</span></span> <span data-ttu-id="a9164-127">若要擷取目前與主控台畫面緩衝區相關聯的各種屬性值，請使用 [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md)、[**GetConsoleCursorInfo**](getconsolecursorinfo.md) 和 [**GetConsoleMode**](getconsolemode.md) 函式。</span><span class="sxs-lookup"><span data-stu-id="a9164-127">To retrieve the current values of the various properties associated with the console screen buffer, use the [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md), [**GetConsoleCursorInfo**](getconsolecursorinfo.md), and [**GetConsoleMode**](getconsolemode.md) functions.</span></span>

<span data-ttu-id="a9164-128">應用程式若變更任何主控台畫面緩衝區屬性，則應該建立自己的畫面緩衝區，或在啟動期間儲存繼承的畫面緩衝區狀態，並在結束時將其還原。</span><span class="sxs-lookup"><span data-stu-id="a9164-128">Applications that change any of the console screen buffer properties should either create their own screen buffer or save the state of the inherited screen buffer during startup and restore it at exit.</span></span> <span data-ttu-id="a9164-129">此合作行為是必要的，因為要確保共用相同主控台工作階段的其他應用程式不會受到變更影響。</span><span class="sxs-lookup"><span data-stu-id="a9164-129">This cooperative behavior is required to ensure that other applications sharing the same console session are not impacted by the changes.</span></span>

> [!TIP]
> <span data-ttu-id="a9164-130">如果可能，建議您日後使用 [**替代緩衝區模式**](console-virtual-terminal-sequences.md#alternate-screen-buffer)來達成此目的，而不是建立第二個畫面緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a9164-130">It is recommended to use the [**alternate buffer mode**](console-virtual-terminal-sequences.md#alternate-screen-buffer) going forward, if possible, instead of creating a second screen buffer for this purpose.</span></span> <span data-ttu-id="a9164-131">**替代緩衝區模式** 會在遠端裝置和其他平台之間提供更高的相容性。</span><span class="sxs-lookup"><span data-stu-id="a9164-131">**Alternate buffer mode** offers increased compatibility across remote devices and with other platforms.</span></span> <span data-ttu-id="a9164-132">如需詳細資訊，請參閱 [**傳統主控台 API 與虛擬終端機**](classic-vs-vt.md)上的討論。</span><span class="sxs-lookup"><span data-stu-id="a9164-132">Please see our discussion on [**classic console APIs versus virtual terminal**](classic-vs-vt.md) for more information.</span></span>

## <a name="cursor-appearance-and-position"></a><span data-ttu-id="a9164-133">游標外觀和位置</span><span class="sxs-lookup"><span data-stu-id="a9164-133">Cursor Appearance and Position</span></span>

<span data-ttu-id="a9164-134">畫面緩衝區的游標可以顯示或隱藏。</span><span class="sxs-lookup"><span data-stu-id="a9164-134">A screen buffer's cursor can be visible or hidden.</span></span> <span data-ttu-id="a9164-135">當其顯示時，其外觀可能會有所不同，從完全填滿字元資料格到顯示為資料格底部水平線都是其範圍。</span><span class="sxs-lookup"><span data-stu-id="a9164-135">When it is visible, its appearance can vary, ranging from completely filling a character cell to appearing as a horizontal line at the bottom of the cell.</span></span> <span data-ttu-id="a9164-136">若要取得游標外觀和可見度的相關資訊，請使用 [**GetConsoleCursorInfo**](getconsolecursorinfo.md) 函式。</span><span class="sxs-lookup"><span data-stu-id="a9164-136">To retrieve information about the appearance and visibility of the cursor, use the [**GetConsoleCursorInfo**](getconsolecursorinfo.md) function.</span></span> <span data-ttu-id="a9164-137">此函式會報告游標是否可見，並將游標的外觀描述為其所在字元資料格的百分比。</span><span class="sxs-lookup"><span data-stu-id="a9164-137">This function reports whether the cursor is visible and describes the appearance of the cursor as the percentage of a character cell that it fills.</span></span> <span data-ttu-id="a9164-138">若要設定游標的外觀和可見度，請使用 [**SetConsoleCursorInfo**](setconsolecursorinfo.md) 函式。</span><span class="sxs-lookup"><span data-stu-id="a9164-138">To set the appearance and visibility of the cursor, use the [**SetConsoleCursorInfo**](setconsolecursorinfo.md) function.</span></span>

<span data-ttu-id="a9164-139">[高階主控台 I/O 函式所撰寫的字元](high-level-console-i-o.md)會寫入目前的游標位置，並將游標往前移到下一個位置。</span><span class="sxs-lookup"><span data-stu-id="a9164-139">Characters written by the [high-level console I/O functions](high-level-console-i-o.md) are written at the current cursor location, advancing the cursor to the next location.</span></span> <span data-ttu-id="a9164-140">若要判斷目前畫面緩衝區座標系統中的游標位置，請使用 [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md)。</span><span class="sxs-lookup"><span data-stu-id="a9164-140">To determine the current cursor position in the coordinate system of a screen buffer, use [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md).</span></span> <span data-ttu-id="a9164-141">您可以使用 [**SetConsoleCursorPosition**](setconsolecursorposition.md) 來設定游標位置，進而控制高階 I/O 函式所撰寫或回應的文字位置。</span><span class="sxs-lookup"><span data-stu-id="a9164-141">You can use [**SetConsoleCursorPosition**](setconsolecursorposition.md) to set the cursor position and, thereby, control the placement of text that is written or echoed by the high-level I/O functions.</span></span> <span data-ttu-id="a9164-142">如果您移動游標，則會覆寫新游標位置上的文字。</span><span class="sxs-lookup"><span data-stu-id="a9164-142">If you move the cursor, text at the new cursor location is overwritten.</span></span>

> [!NOTE]
> <span data-ttu-id="a9164-143">不建議使用低階函式來尋找游標位置。</span><span class="sxs-lookup"><span data-stu-id="a9164-143">Using the low-level functions to find the cursor position is discouraged.</span></span> <span data-ttu-id="a9164-144">如果需要進行進階配置，建議使用[虛擬終端機序列](console-virtual-terminal-sequences.md)來查詢此位置。</span><span class="sxs-lookup"><span data-stu-id="a9164-144">It is recommended to use [virtual terminal sequences](console-virtual-terminal-sequences.md) to query this position if necessary for advanced layouts.</span></span> <span data-ttu-id="a9164-145">如需有關為何偏好虛擬終端機序列的詳細資訊，請參閱 **[傳統函式與虛擬終端機](classic-vs-vt.md)** 文件。</span><span class="sxs-lookup"><span data-stu-id="a9164-145">More information about preferring virtual terminal sequences can be found in the **[classic functions versus virtual terminal](classic-vs-vt.md)** document.</span></span>

<span data-ttu-id="a9164-146">游標的位置、外觀和可見度都會針對每個畫面緩衝區個別設定。</span><span class="sxs-lookup"><span data-stu-id="a9164-146">The position, appearance, and visibility of the cursor are set independently for each screen buffer.</span></span>

## <a name="character-attributes"></a><span data-ttu-id="a9164-147">字元屬性</span><span class="sxs-lookup"><span data-stu-id="a9164-147">Character Attributes</span></span>

<span data-ttu-id="a9164-148">字元屬性可以分成兩個類別：色彩和 DBCS。</span><span class="sxs-lookup"><span data-stu-id="a9164-148">Character attributes can be divided into two classes: color and DBCS.</span></span> <span data-ttu-id="a9164-149">下列屬性會定義於 `WinCon.h` 標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="a9164-149">The following attributes are defined in the `WinCon.h` header file.</span></span>

| <span data-ttu-id="a9164-150">屬性</span><span class="sxs-lookup"><span data-stu-id="a9164-150">Attribute</span></span> | <span data-ttu-id="a9164-151">意義</span><span class="sxs-lookup"><span data-stu-id="a9164-151">Meaning</span></span> |
|-|-|
| <span data-ttu-id="a9164-152">**FOREGROUND\_BLUE**</span><span class="sxs-lookup"><span data-stu-id="a9164-152">**FOREGROUND\_BLUE**</span></span> | <span data-ttu-id="a9164-153">文字色彩包含藍色。</span><span class="sxs-lookup"><span data-stu-id="a9164-153">Text color contains blue.</span></span> |
| <span data-ttu-id="a9164-154">**FOREGROUND\_GREEN**</span><span class="sxs-lookup"><span data-stu-id="a9164-154">**FOREGROUND\_GREEN**</span></span> | <span data-ttu-id="a9164-155">文字色彩包含綠色。</span><span class="sxs-lookup"><span data-stu-id="a9164-155">Text color contains green.</span></span> |
| <span data-ttu-id="a9164-156">**FOREGROUND\_RED**</span><span class="sxs-lookup"><span data-stu-id="a9164-156">**FOREGROUND\_RED**</span></span> | <span data-ttu-id="a9164-157">文字色彩包含紅色。</span><span class="sxs-lookup"><span data-stu-id="a9164-157">Text color contains red.</span></span> |
| <span data-ttu-id="a9164-158">**FOREGROUND\_INTENSITY**</span><span class="sxs-lookup"><span data-stu-id="a9164-158">**FOREGROUND\_INTENSITY**</span></span> | <span data-ttu-id="a9164-159">加深文字色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-159">Text color is intensified.</span></span> |
| <span data-ttu-id="a9164-160">**BACKGROUND\_BLUE**</span><span class="sxs-lookup"><span data-stu-id="a9164-160">**BACKGROUND\_BLUE**</span></span> | <span data-ttu-id="a9164-161">背景色彩包含藍色。</span><span class="sxs-lookup"><span data-stu-id="a9164-161">Background color contains blue.</span></span> |
| <span data-ttu-id="a9164-162">**BACKGROUND\_GREEN**</span><span class="sxs-lookup"><span data-stu-id="a9164-162">**BACKGROUND\_GREEN**</span></span> | <span data-ttu-id="a9164-163">背景色彩包含綠色。</span><span class="sxs-lookup"><span data-stu-id="a9164-163">Background color contains green.</span></span> |
| <span data-ttu-id="a9164-164">**BACKGROUND\_RED**</span><span class="sxs-lookup"><span data-stu-id="a9164-164">**BACKGROUND\_RED**</span></span> | <span data-ttu-id="a9164-165">背景色彩包含紅色。</span><span class="sxs-lookup"><span data-stu-id="a9164-165">Background color contains red.</span></span> |
| <span data-ttu-id="a9164-166">**BACKGROUND\_INTENSITY**</span><span class="sxs-lookup"><span data-stu-id="a9164-166">**BACKGROUND\_INTENSITY**</span></span> | <span data-ttu-id="a9164-167">加深背景色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-167">Background color is intensified.</span></span> |
| <span data-ttu-id="a9164-168">**COMMON\_LVB\_LEADING\_BYTE**</span><span class="sxs-lookup"><span data-stu-id="a9164-168">**COMMON\_LVB\_LEADING\_BYTE**</span></span> | <span data-ttu-id="a9164-169">前置位元組。</span><span class="sxs-lookup"><span data-stu-id="a9164-169">Leading byte.</span></span> |
| <span data-ttu-id="a9164-170">**COMMON\_LVB\_TRAILING\_BYTE**</span><span class="sxs-lookup"><span data-stu-id="a9164-170">**COMMON\_LVB\_TRAILING\_BYTE**</span></span> | <span data-ttu-id="a9164-171">尾端位元組。</span><span class="sxs-lookup"><span data-stu-id="a9164-171">Trailing byte.</span></span> |
| <span data-ttu-id="a9164-172">**COMMON\_LVB\_GRID\_HORIZONTAL**</span><span class="sxs-lookup"><span data-stu-id="a9164-172">**COMMON\_LVB\_GRID\_HORIZONTAL**</span></span> | <span data-ttu-id="a9164-173">水平置頂。</span><span class="sxs-lookup"><span data-stu-id="a9164-173">Top horizontal.</span></span> |
| <span data-ttu-id="a9164-174">**COMMON\_LVB\_GRID\_LVERTICAL**</span><span class="sxs-lookup"><span data-stu-id="a9164-174">**COMMON\_LVB\_GRID\_LVERTICAL**</span></span> | <span data-ttu-id="a9164-175">垂直靠左。</span><span class="sxs-lookup"><span data-stu-id="a9164-175">Left vertical.</span></span> |
| <span data-ttu-id="a9164-176">**COMMON\_LVB\_GRID\_RVERTICAL**</span><span class="sxs-lookup"><span data-stu-id="a9164-176">**COMMON\_LVB\_GRID\_RVERTICAL**</span></span> | <span data-ttu-id="a9164-177">垂直靠右。</span><span class="sxs-lookup"><span data-stu-id="a9164-177">Right vertical.</span></span> |
| <span data-ttu-id="a9164-178">**COMMON\_LVB\_REVERSE\_VIDEO**</span><span class="sxs-lookup"><span data-stu-id="a9164-178">**COMMON\_LVB\_REVERSE\_VIDEO**</span></span> | <span data-ttu-id="a9164-179">反轉前景和背景屬性。</span><span class="sxs-lookup"><span data-stu-id="a9164-179">Reverse foreground and background attributes.</span></span> |
| <span data-ttu-id="a9164-180">**COMMON\_LVB\_UNDERSCORE**</span><span class="sxs-lookup"><span data-stu-id="a9164-180">**COMMON\_LVB\_UNDERSCORE**</span></span> | <span data-ttu-id="a9164-181">底線。</span><span class="sxs-lookup"><span data-stu-id="a9164-181">Underscore.</span></span> |

<span data-ttu-id="a9164-182">前景屬性會指定文字色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-182">The foreground attributes specify the text color.</span></span> <span data-ttu-id="a9164-183">背景屬性會指定用來填滿資料格背景的色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-183">The background attributes specify the color used to fill the cell's background.</span></span> <span data-ttu-id="a9164-184">其他屬性會與 [DBCS](/windows/win32/intl/double-byte-character-sets) 搭配使用。</span><span class="sxs-lookup"><span data-stu-id="a9164-184">The other attributes are used with [DBCS](/windows/win32/intl/double-byte-character-sets).</span></span>

<span data-ttu-id="a9164-185">應用程式可以結合前景和背景常數來達到不同的色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-185">An application can combine the foreground and background constants to achieve different colors.</span></span> <span data-ttu-id="a9164-186">例如，下列組合會在藍色背景上產生明亮的青色文字。</span><span class="sxs-lookup"><span data-stu-id="a9164-186">For example, the following combination results in bright cyan text on a blue background.</span></span>

`FOREGROUND_BLUE | FOREGROUND_GREEN | FOREGROUND_INTENSITY | BACKGROUND_BLUE`

<span data-ttu-id="a9164-187">如果未指定背景常數，則背景會是黑色，如果未指定任何前景常數，則文字會是黑色。</span><span class="sxs-lookup"><span data-stu-id="a9164-187">If no background constant is specified, the background is black, and if no foreground constant is specified, the text is black.</span></span> <span data-ttu-id="a9164-188">例如，下列組合會在白色背景上產生黑色文字。</span><span class="sxs-lookup"><span data-stu-id="a9164-188">For example, the following combination produces black text on a white background.</span></span>

`BACKGROUND_BLUE | BACKGROUND_GREEN | BACKGROUND_RED`

<span data-ttu-id="a9164-189">每個畫面緩衝區字元資料格都會儲存色彩屬性，以用於繪製該儲存格的前景 (文字) 和背景色彩。</span><span class="sxs-lookup"><span data-stu-id="a9164-189">Each screen buffer character cell stores the color attributes for the colors used in drawing the foreground (text) and background of that cell.</span></span> <span data-ttu-id="a9164-190">應用程式可以個別設定每個字元資料格的色彩資料，並針對每個資料格將該資料儲存為 [**CHAR\_INFO**](char-info-str.md) 結構的 **屬性** 成員。</span><span class="sxs-lookup"><span data-stu-id="a9164-190">An application can set the color data for each character cell individually, storing the data in the **Attributes** member of the [**CHAR\_INFO**](char-info-str.md) structure for each cell.</span></span> <span data-ttu-id="a9164-191">每個畫面緩衝區目前的文字屬性之後都會用在高階函式所撰寫或回應的字元上。</span><span class="sxs-lookup"><span data-stu-id="a9164-191">The current text attributes of each screen buffer are used for characters subsequently written or echoed by the high-level functions.</span></span>

<span data-ttu-id="a9164-192">應用程式可以使用 [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) 來判斷畫面緩衝區目前的文字屬性，以及使用 [**SetConsoleTextAttribute**](setconsoletextattribute.md) 函式來設定字元屬性。</span><span class="sxs-lookup"><span data-stu-id="a9164-192">An application can use [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) to determine the current text attributes of a screen buffer and the [**SetConsoleTextAttribute**](setconsoletextattribute.md) function to set the character attributes.</span></span> <span data-ttu-id="a9164-193">變更畫面緩衝區的屬性並不會影響先前撰寫的字元顯示。</span><span class="sxs-lookup"><span data-stu-id="a9164-193">Changing a screen buffer's attributes does not affect the display of characters previously written.</span></span> <span data-ttu-id="a9164-194">這些文字屬性不會影響低階主控台 I/O 函式所撰寫的字元 (例如 [**WriteConsoleOutput**](writeconsoleoutput.md) 或 [**WriteConsoleOutputCharacter**](writeconsoleoutputcharacter.md) 函式)，這些函式可明確指定每個資料格的屬性，或將屬性保留不變。</span><span class="sxs-lookup"><span data-stu-id="a9164-194">These text attributes do not affect characters written by the low-level console I/O functions (such as the [**WriteConsoleOutput**](writeconsoleoutput.md) or [**WriteConsoleOutputCharacter**](writeconsoleoutputcharacter.md) function), which either explicitly specify the attributes for each cell that is written or leave the attributes unchanged.</span></span>

> [!NOTE]
> <span data-ttu-id="a9164-195">不建議使用低階函式來操作預設和特定的文字屬性。</span><span class="sxs-lookup"><span data-stu-id="a9164-195">Using the low-level functions to manipulate default and specific text attributes is discouraged.</span></span> <span data-ttu-id="a9164-196">建議使用[虛擬終端機序列](console-virtual-terminal-sequences.md)來設定文字屬性。</span><span class="sxs-lookup"><span data-stu-id="a9164-196">It is recommended to use [virtual terminal sequences](console-virtual-terminal-sequences.md) to set text attributes.</span></span> <span data-ttu-id="a9164-197">如需有關為何偏好虛擬終端機序列的詳細資訊，請參閱 **[傳統函式與虛擬終端機](classic-vs-vt.md)** 文件。</span><span class="sxs-lookup"><span data-stu-id="a9164-197">More information about preferring virtual terminal sequences can be found in the **[classic functions versus virtual terminal](classic-vs-vt.md)** document.</span></span>

## <a name="font-attributes"></a><span data-ttu-id="a9164-198">字型屬性</span><span class="sxs-lookup"><span data-stu-id="a9164-198">Font Attributes</span></span>

<span data-ttu-id="a9164-199">[**GetCurrentConsoleFont**](getcurrentconsolefont.md) 函式會擷取目前主控台字型的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a9164-199">The [**GetCurrentConsoleFont**](getcurrentconsolefont.md) function retrieves information about the current console font.</span></span> <span data-ttu-id="a9164-200">儲存在 [**CONSOLE\_FONT\_INFO**](console-font-info-str.md) 結構中的資訊包含該字型的每個字元寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="a9164-200">The information stored in the [**CONSOLE\_FONT\_INFO**](console-font-info-str.md) structure includes the width and height of each character in the font.</span></span>

<span data-ttu-id="a9164-201">[**GetConsoleFontSize**](getconsolefontsize.md) 函式會擷取指定主控台畫面緩衝區所使用的字型大小。</span><span class="sxs-lookup"><span data-stu-id="a9164-201">The [**GetConsoleFontSize**](getconsolefontsize.md) function retrieves the size of the font used by the specified console screen buffer.</span></span>

> [!NOTE]
> <span data-ttu-id="a9164-202">不建議使用函式來尋找和操作字型資訊。</span><span class="sxs-lookup"><span data-stu-id="a9164-202">Using functions to find and manipulate font information is discouraged.</span></span> <span data-ttu-id="a9164-203">建議使用中性字型操作命令列應用程式，以確保可與各平台及主機環境相容，進而允許使用者自訂字型。</span><span class="sxs-lookup"><span data-stu-id="a9164-203">It is recommended to operate command-line applications in a font neutral manner to ensure cross-platform compatibility as well as compatibility with host environments that allow the user to customize the font.</span></span> <span data-ttu-id="a9164-204">如需有關使用者喜好設定和主機環境 (包括終端機) 的詳細資訊，請參閱 **[生態系統藍圖](ecosystem-roadmap.md)** 。</span><span class="sxs-lookup"><span data-stu-id="a9164-204">More information user preferences and host environments including terminals, please see the **[ecosystem roadmap](ecosystem-roadmap.md)**.</span></span>